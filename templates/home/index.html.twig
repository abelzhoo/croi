{% extends 'base.html.twig' %}

{% block stylesheets %}
<style>
    area:hover{
      outline: 'none';
      backgroundColor: 'red';
    }
    .map__image{
      width: 25%;
      float: left;
    }
    .map__image path{
     fill: #1e357d;
     stroke: #FFF;
     stroke-width: 1px;
    }
    .map__image path:hover{
     fill: #FF6400;
    }
    
    [id*='region-']{
      cursor: pointer;
    }
  </style>
  {% endblock %}

{% block content %}
<div id="content">
    <div id="content-header">
    <div id="breadcrumb"> <a href="index.html" title="Go to Home" class="tip-bottom"><i class="icon-home"></i> Accueil</a></div>
    </div>

    <div class="container-fluid">
    <div class="quick-actions_homepage">
        <ul class="quick-actions">
            {% if is_granted('ROLE_SANTE') %}
                <li class="bg_lb span3">
                    <a href="#" onClick="analyticSante()"> <i class="icon-dashboard"></i> <span class="label label-important"></span> SANTE </a>
                </li>
            {% endif %}
            {% if is_granted('ROLE_EDUCATION') %}
                <li class="bg_lg span3">
                    <a href="#" onClick="analyticEducation()"> <i class="icon-signal"></i> EDUCATION</a>
                </li>
            {% endif %}
            {% if is_granted('ROLE_LOGEMENT') %}
                <li class="bg_ly span3">
                    <a href="#" onClick="analyticLogement()"> <i class="icon-inbox"></i><span class="label label-success"></span> LOGEMENT </a>
                </li>
            {% endif %}
            {% if is_granted('ROLE_SOCIAL') %}
                <li class="bg_lo span3">
                    <a href="#" onClick="analyticSocial()"> <i class="icon-th"></i> SOCIAL</a>
                </li>
            {% endif %}
            {% if is_granted('ROLE_PROFESSION') %}
                <li class="bg_ls span3">
                    <a href="#" onClick="analyticProfession()"> <i class="icon-fullscreen"></i> PROFESSION</a>
                </li>
            {% endif %}
        </ul>
    </div>

    <div class="row-fluid">
      <div class="span12">
        <div class="widget-box">
          <div class="widget-title"> <span class="icon"> <i class="icon-signal"></i> </span>
            <h5>Turning-series chart</h5>
          </div>
          <div class="widget-content">
            <div id="placeholder"></div>
            <p id="choices"></p>
          </div>
        </div>
      </div>
    </div>
<!--End-Chart-box-->
</div>
{% endblock %}

{% block javascripts %}
    <script>
        var etudiants = JSON.stringify({{ etudiants|json_encode|raw }});
        var non_etudiants = JSON.stringify({{ non_etudiants|json_encode|raw }});

        $(function () {

        var datasets = {
            "etudiant": {
                label: "Étudiant",
                data: JSON.parse(etudiants)
            },
            "non_etudiant": {
                label: "Non étudiant",
                data: JSON.parse(non_etudiants)
            }
        };

        // hard-code color indices to prevent them from shifting as
        // countries are turned on/off
        var i = 0;
        $.each(datasets, function(key, val) {
            val.color = i;
            ++i;
        });

        // insert checkboxes
        var choiceContainer = $("#choices");
        $.each(datasets, function(key, val) {
            choiceContainer.append('<br/><input type="checkbox" name="' + key +
                                   '" checked="checked" id="id' + key + '">' +
                                   '<label for="id' + key + '">'
                                    + val.label + '</label>');
        });
        choiceContainer.find("input").click(plotAccordingToChoices);


        function plotAccordingToChoices() {
            var data = [];

            choiceContainer.find("input:checked").each(function () {
                var key = $(this).attr("name");
                if (key && datasets[key])
                    data.push(datasets[key]);
            });

            if (data.length > 0)
                $.plot($("#placeholder"), data, {
                    yaxis: { min: 0, max: 100 },
                    xaxis: { tickDecimals: 0 }
                });
        }

        plotAccordingToChoices();
    });
    </script>
{% endblock %}